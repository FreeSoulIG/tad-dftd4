"""
Data for testing D4 coordination number (taken from D4 testsuite).
"""

import torch

from tad_dftd4.typing import Molecule, Tensor, TypedDict

from ..molecules import merge_nested_dicts, mols
from ..util import reshape_fortran


class Refs(TypedDict):
    """Format of reference values."""

    gw: Tensor
    """Gaussian weights."""


class Record(Molecule, Refs):
    """Store for molecular information and reference values."""


refs: dict[str, Refs] = {
    "MB16_43_01": {
        "gw": reshape_fortran(
            torch.tensor(
                [
                    1.2088234202205e-11,
                    1.0375924114812e00,
                    2.4445602531076e-09,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    5.5306460372092e-03,
                    9.9446935396279e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    3.1404764970412e-06,
                    6.3956931077352e-02,
                    4.7846317290481e-01,
                    2.9468368515225e-01,
                    0.0000000000000e00,
                    7.4310920077799e-05,
                    9.9992568907992e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    4.4395780891660e-02,
                    8.5383545436310e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.1950286131613e-02,
                    9.8804971386839e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    5.6992908407601e-05,
                    9.9994300709159e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    5.6167960886507e-07,
                    2.9078967459651e-02,
                    6.1859560324107e-01,
                    1.5104287585421e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    4.9771287942905e-14,
                    1.3962072360858e-04,
                    6.8484995485525e-01,
                    1.6516463249478e-12,
                    1.9880162618842e-02,
                    9.8011983738116e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.1966389405645e-02,
                    9.8803361059436e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.2874045548253e-05,
                    9.7726740456727e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    4.1491138092838e-06,
                    8.6768202830170e-01,
                    0.0000000000000e00,
                    4.3169267440676e-12,
                    3.6465051654232e-04,
                    8.8903503100593e-01,
                    1.2720379452861e-05,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.4066048552144e-05,
                    6.8494819902320e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.9574616732692e-10,
                    1.0064486114128e00,
                    0.0000000000000e00,
                ],
                dtype=torch.double,
            ),
            (5, 16),
        )
    },
    "MB16_43_02": {
        "gw": reshape_fortran(
            torch.tensor(
                [
                    8.1529926850468e-01,
                    2.2414425700956e-03,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.0229633690838e00,
                    2.0291440612814e-03,
                    4.4863013350169e-10,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.1578430925721e00,
                    2.0553787158892e-03,
                    3.1900095597967e-10,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.3687709975145e00,
                    8.2192921625604e-03,
                    5.9806186105627e-08,
                    1.4414431691639e-03,
                    0.0000000000000e00,
                    9.1646421111918e-01,
                    5.3618567538002e-03,
                    1.7524886555881e-08,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    5.5812105498128e-01,
                    1.5344013422165e-03,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    7.5659186904499e-01,
                    2.0800426162236e-03,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    7.7216222381926e-01,
                    2.1228490523027e-03,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    9.9399938189677e-01,
                    2.8186797641147e-03,
                    7.1776130956295e-10,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    5.5220460179834e-01,
                    1.5181356707747e-03,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.1425733041093e00,
                    2.0284312531719e-03,
                    3.1484305175579e-10,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    8.1572049134917e-01,
                    6.4067287425100e-03,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.2272138342948e00,
                    1.3612868628584e-02,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    8.3285816475829e-01,
                    2.2897159576321e-03,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    7.4607907232618e-01,
                    2.0511405541139e-03,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.0523038058719e00,
                    2.0872155477415e-03,
                    4.6145584504737e-10,
                    0.0000000000000e00,
                    0.0000000000000e00,
                ],
                dtype=torch.double,
            ),
            (5, 16),
        )
    },
    "MB16_43_03": {
        "gw": reshape_fortran(
            torch.tensor(
                [
                    0.0000000000000e00,
                    0.0000000000000e00,
                    3.9504240794198e-09,
                    1.0097386820563e-02,
                    9.3220073517801e-01,
                    2.5639475147259e-02,
                    0.0000000000000e00,
                    1.4797717135069e-11,
                    1.9052325554662e-04,
                    1.1116141991349e00,
                    2.9351813145404e-03,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    5.3735027174640e-03,
                    8.8839284731689e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    9.7753605500113e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    9.8036041832883e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.2906805265616e-09,
                    9.9812405470369e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    3.9706733315821e-14,
                    3.4070161345981e-05,
                    1.0390095052930e00,
                    1.4775589359887e-04,
                    0.0000000000000e00,
                    1.4709587472355e-03,
                    8.7779708361772e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    4.9950676848882e-03,
                    8.2586385264927e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    4.7331797500540e-03,
                    7.8936056984439e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    6.1261133783377e-04,
                    1.1351788724746e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.4636823892691e-06,
                    1.0081631910738e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    1.5989624842058e-05,
                    1.0653935240443e00,
                    7.4688541496264e-05,
                    0.0000000000000e00,
                    9.7208858575852e-03,
                    5.7638169663657e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    5.8433000707751e-10,
                    9.6868781982789e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    2.8478831017041e-04,
                    9.0297474706410e-01,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                    0.0000000000000e00,
                ],
                dtype=torch.double,
            ),
            (7, 16),
        )
    },
}


samples: dict[str, Record] = merge_nested_dicts(mols, refs)
